<html>

<script>
//n and matrix is a global var


function createArray(n){
   var matrix = new Array(n);
    for (var i = 0; i < n; i++) {
        matrix[i] = new Array(n);
        matrix[i] = matrix[i].fill(0);
    }
  return matrix;
}

function checkSolved(matrix,n){
  //fill the matrix with 0s
  var counter = 0;
  for (var i = 0; i < n; i++) {
    for (var j = 0; j < n; j++) {
        if(matrix[i][j] == 1){
          counter += 1;
        }
        if(counter >= n){
          // solved!
          return true;
        }
    }
  }
  return false;
}

//for loop from 0 to n
function checkListY(y,matrix,n){
    for (var i = 0; i < n; i++) {
        if(matrix[i][y] == 1){
            return false;
        }
    }
    return true;
}

//a function to check if  ther is a 1 in a list in matrix
function checkListX(x,matrix) {
    return !matrix[x].includes(1);
   
   
}
function checkListDiagonals(x,y,matrix,n){
    if( checkDiagonal(x,y,true,true,matrix,n) &&
        checkDiagonal(x,y,true,false,matrix,n) &&
        checkDiagonal(x,y,false,true,matrix,n) &&
        checkDiagonal(x,y,false,false,matrix,n)){            
        return true;
    } else {
        return false;
    }
}
function checkDiagonal(x,y,xPositive,yPositive,matrix,n){
    while (x>=0 && y>=0 && x < n && y < n){
        if(matrix[x][y] == 1){
            return false;
        }
        if (xPositive) x++;
        else x--;
        if (yPositive) y++;
        else y--;
        
    }
    return true;
}

function check(x,y,matrix,n){
    if( checkListX(x,matrix,n) &&
      checkListY(y,matrix,n) && checkListDiagonals(x,y,matrix,n)){
        return true;
    } else {
        return false;
    }
}

function placeQueen(matrix,n){
    
    var x = prompt("Enter row number");
    var y = prompt("Enter col number");
    if(check(x,y,matrix,n)){
        matrix[x][y] = 1;
        return matrix;
    }
    else{
        alert("Cant do that!");
        return placeQueen(matrix,n);
    }

}
function preFillQueens(matrix,n){
    preFillNum = prompt("How many queens do you want to prefill?");
    if (preFillNum > n || preFillNum < 0){
        alert("Cant do that!");
        return preFillQueens(matrix,n);
    }
    else if (preFillQueens == 0){
        return matrix;
    }
    else{
        for (var i = 0; i < preFillNum; i++) {
          matrix = placeQueen(matrix,n);
        }
    }
   
return matrix;
}

function main(n){
 
var startMatrix = preFillQueens(createArray(n),n);
var matrix = startMatrix;

 while(!checkSolved(matrix,n)){
    console.info('startpotential');
    console.table(startMatrix);
  matrix  = startMatrix;
   for ( var y = 0; y < n; y++){
      var placed = [];
      var notPlaced = true;
      //console.log('y',y);
      while (notPlaced){
          var x = Math.floor(Math.random() * n); //0-1 * n as math.random gives a number between 0-1
          //console.log('x',x);
          //console.log('placed array',placed);
          if (!placed.includes(x)){
              if(check(x,y,matrix,n)){
                  //console.log('placed',x,y);
                  matrix[x][y] = 1;    
                  notPlaced = false;
              } else {
                  placed.push(x);
                  //console.log('placed array',placed);
              }
          } else if(placed.length >= n){
            notPlaced = false;
            //console.table(matrix);
          }
      }
   }
   console.info('potential');
    console.table(matrix);
 }
  return matrix;
}

// init
//accept user input for a variable called n
var number = 5;
console.log('Number',number)

// create a n x n matrix
var matrix = main(number);
console.info('after')
console.table(matrix);
</script>

<body>
    <ul id="list"></ul>
    <script>
        var list = document.getElementById("list");
        for (var i = 0; i < matrix.length; i++) {
            var li = document.createElement("li");
            li.appendChild(document.createTextNode(matrix[i]));
            list.appendChild(li);
        }
    </script>
</body>


</html>
